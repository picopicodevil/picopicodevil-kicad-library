# PCIe コンポーネントとフットプリント

## 使い方

### コンポーネント

1. コンポーネントライブラリ(PCIe.libとPCIe.dcm)をダウンロードする。
2. 回路図エディタ(Eeschema)を起動する。
3. 設定からコンポーネントライブラリを開く。
4. 「ユーザ定義の検索パス」の「追加」ボタンをクリックして、ダウンロードしたアイブラリーのあるフォルダを指定する。パスは、絶対でも相対でも良い。
5. コンポーネントライブラリの「追加」または「挿入」ボタンをクリックして、ダウンロードしたPCIe.libを開く。
6. 「OK」をクリックしてダイアログを閉じる。

これでKiCadと一緒に配布されるコンポーネントと同様に使用できます。

### フットプリント

1. プリント基板エディタ(Pcbnew)を起動する。
2. 「設定」から「フットプリントライブラリの管理」を開く。
3. 「グローバルライブラリ」または「プロジェクト固有のライブラリ」をタブで選ぶ。
4. 「ライブラリの追加」ボタンをクリックする。「ウィザードを使用して追加」はうまく行かない。
5. 「ライブラリの一覧」の最後に追加された欄に次のテーブル内容を書き込む。他のカラムは空白のままにする。別名は、好きな名前を指定できます。
6. 「OK」をクリックしてダイアログを閉じる。

| 別名(ニックネーム) | ライブラリのパス               | プラグインの種類 |
| ------------------ | ------------------------------ | ---------------- |
| PCIe               | ダウンロードしたフォルダのパス | Kicad            |

追加したライブラリーは、Pcbnewの上部メニューの下に有るICに虫眼鏡のアイコン(フットプリントビューアを開く)を使うのが簡単です。

1. 「フットプリントビューアを開く」アイコンをクリックする。
2. 一番左のカラムから追加したフットプリントライブラリを選択する。

これでフットプリントの一覧が表示されればライブラリの追加成功です。

## コンポーネントとフットプリント一覧

このレポジトリーには、次のコンポーネントとフットプリントが含まれています。

### コンポーネントと対応するフットプリント

| component                                | footprint                                |
| ---------------------------------------- | ---------------------------------------- |
| Bus_PCIexpress_x1_36_Position            | Bus_PCIexpress_x1_36_Position            |
| Bus_PCIexpress_x4_64_Position            | Bus_PCIexpress_x4_64_Position            |
| Bus_PCIexpress_x8_98_Position            | Bus_PCIexpress_x8_98_Position            |
| Bus_PCIexpress_x16_164_Position          | Bus_PCIexpress_x16_164_Position          |
| Bus_mechaken_PCIexpress_x16_164_Position | Bus_mechaken_PCIexpress_x16_164_Position |

## ピン配置

独自の実装として、PCIeのピン配置を大幅に変更しています。

| 役割   | ピン番号                                   | 説明                                     |
| ------ | ------------------------------------------ | ---------------------------------------- |
| +5V    | A1, A2, B1, B2                             | 制御側                                   |
| GND    | A3, A4, B3, B4                             | 制御側                                   |
| CANL   | A5                                         | 制御側                                   |
| CANH   | A6                                         | 制御側                                   |
| Pin_B5 | B5                                         | 制御側（Reserved）                       |
| Pin_B6 | B6                                         | 制御側（Reserved）                       |
| +BATT  | A7, A8, B7, B8                             | 制御側（バッテリーからの電源（7.4V等）） |
| VCC    | A9 ~ A13, A23 ~ A52, B9 ~ B13, B23 ~ B52   | 駆動側                                   |
| GNDPWR | A14 ~ A22, A53 ~ A82, B14 ~ B22, B53 ~ B82 | 駆動側                                   |

## 注意事項

ピン配置が違うので、モータードライバ等をほかのPCIeスロットに刺したり、GPU等をマザーボードに刺すことは絶対にしないでください。